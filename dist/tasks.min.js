var Tasks;!function(t){var s;!function(t){t[t.CREATED=0]="CREATED",t[t.WAITING=1]="WAITING",t[t.RUNNING=2]="RUNNING",t[t.FULFILLED=3]="FULFILLED",t[t.REJECTED=4]="REJECTED"}(s||(s={}));var a=function(){function t(t,s){this.parent=t,this.callback=s}return t}(),e=function(){function t(t){var e=this;if(this.status=s.CREATED,this.data=null,this.err=null,this.childCry=new Array,t instanceof a)switch(this.thenCallback=t.callback,this.parent=t.parent,this.parent.status){case s.FULFILLED:this.executeCallback();break;case s.REJECTED:this.status=s.REJECTED;break;default:this.status=s.WAITING,this.parent.onComplete(function(t,a){e.data=t,e.err=a,e.parent.status==s.REJECTED&&(e.status=s.REJECTED),e.executeCallback()})}else this.thenCallback=t,this.executeCallback()}return t.prototype.getParent=function(){return this.parent},t.prototype.getChild=function(){return this.child},t.prototype.resolve=function(t){this.status!=s.FULFILLED&&this.status!=s.REJECTED&&(this.status=s.FULFILLED,this.data=t,this.complete())},t.prototype.reject=function(t){this.status!=s.FULFILLED&&this.status!=s.REJECTED&&(this.status=s.REJECTED,this.err=t,this.complete())},t.prototype.executeCallback=function(){var t=this;try{this.status=s.RUNNING,this.parent&&this.parent.status===s.REJECTED?this.catchCallback&&this.catchCallback(this.err,this.data):this.thenCallback&&this.thenCallback(function(s){return t.resolve(s)},function(s){return t.reject(s)},this.data)}catch(a){this.status=s.REJECTED,this.reject(a)}},t.prototype.then=function(s){var e=this,i=new t(new a(this,s));if(!this.child)return this.child=i;for(;e.getChild();)e=e.getChild();return e.then(s)},t.prototype["catch"]=function(t){this.catchCallback=t},t.prototype.onComplete=function(t){this.childCry.push(t)},t.prototype.complete=function(){var t=this;this.childCry.forEach(function(s){return s(t.data,t.err)})},t}();t.Task=e}(Tasks||(Tasks={}));